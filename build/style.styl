@-moz-document url-prefix("https://www.youtube.com") {

  #copyright div::after {
    white-space: pre;
    content: "\aYoutube Tweaks - Version [[VERSION]]";
  }

  if videos-per-row {
    ytd-rich-grid-renderer,
    ytd-rich-item-renderer[is-responsive-grid="STANDARD"]:not([is-post]),
    :root {
      --ytd-rich-grid-items-per-row: videos-per-row !important;
    }

    ytd-rich-section-renderer {
      order: -1;
    }

    #home-container-media .rich-grid-media-skeleton {
      max-width: "calc(100%/%s - 16px)" % videos-per-row !important;
      min-width: "calc(100%/%s - 16px)" % videos-per-row !important;
    }

    ytd-rich-grid-media[mini-mode],
    ytd-rich-grid-renderer[is-slim-grid] #contents.ytd-rich-grid-renderer {
      max-width: initial;
    }

    ytd-two-column-browse-results-renderer[page-subtype="channels"]:has(ytd-rich-grid-renderer:not([is-shorts-grid])) {
      width: calc(100% - 32px) !important;
      max-width: calc(var(--ytd-rich-grid-items-per-row) * (var(--ytd-rich-grid-item-max-width) + var(--ytd-rich-grid-item-margin))) !important;
    }

    ytd-rich-item-renderer:nth-child(n + 3):nth-child(-n + {videos-per-row}):has(#video-title.ytd-rich-grid-media)[hidden] {
      display: block !important;
    }

    [style="--ytd-rich-shelf-items-count: 3;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "2";
    }

    [style="--ytd-rich-shelf-items-count: 4;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "3";
    }

    [style="--ytd-rich-shelf-items-count: 5;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "4";
    }

    [style="--ytd-rich-shelf-items-count: 6;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "5";
    }

    [style="--ytd-rich-shelf-items-count: 7;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "6";
    }

    [style="--ytd-rich-shelf-items-count: 8;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "7";
    }

    [style="--ytd-rich-shelf-items-count: 9;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "8";
    }

    [style="--ytd-rich-shelf-items-count: 10;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "9";
    }

    [style="--ytd-rich-shelf-items-count: 11;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "10";
    }

    [style="--ytd-rich-shelf-items-count: 12;"]:has(#video-title.ytd-rich-grid-media) .expand-collapse-button.ytd-rich-shelf-renderer {
      display: none if videos-per-row > "11";
    }
  }

  #content.ytd-rich-section-renderer {
    margin: 0 8px;
  }

  ytd-rich-item-renderer[rendered-from-rich-grid] {
    width: calc(100% / var(--ytd-rich-grid-items-per-row) - var(--ytd-rich-grid-item-margin) - .01px) !important;
    margin-left: calc(var(--ytd-rich-grid-item-margin)/2) !important;
    margin-right: calc(var(--ytd-rich-grid-item-margin)/2) !important;
  }

  [is-default-grid] > #contents.ytd-rich-grid-renderer {
    width: calc(100% - 32px);
    max-width: calc(var(--ytd-rich-grid-items-per-row) * (var(--ytd-rich-grid-item-max-width) + var(--ytd-rich-grid-item-margin)));
  }

  .skeleton-bg-color.ytd-ghost-grid-renderer,
  ytd-rich-item-renderer:has(ytd-ad-slot-renderer) {
    display: none;
  }

  if smaller-font {
    :root {
      --smaller-font-1-4rem: 1.4rem;
      --smaller-font-2rem: 2rem;
      --smaller-font-1-2rem: 1.2rem;
      --smaller-font-1-8rem: 1.8rem;
    }

    ytd-rich-item-renderer .yt-lockup-metadata-view-model-wiz__title,
    #video-title[class*="style-scope ytd-rich-grid"],
    ytd-game-details-renderer[is-rich-grid]:not([mini-mode]) #title.ytd-game-details-renderer,
    yt-lockup-metadata-view-model .yt-lockup-metadata-view-model__title {
      font-size: 1.4rem !important;
      line-height: 2rem !important;
    }

    ytd-rich-item-renderer .yt-content-metadata-view-model-wiz__metadata-text,
    .ytd-rich-grid-media ytd-video-meta-block[rich-meta] .ytd-video-meta-block:is(#byline-container, #metadata-line),
    yt-lockup-metadata-view-model .yt-content-metadata-view-model__metadata-text {
      font-size: 1.2rem !important;
      line-height: 1.8rem !important;
    }
  }

  if show-full-titles {
    ytd-rich-item-renderer .yt-lockup-metadata-view-model-wiz__title,
    ytd-grid-video-renderer #video-title.yt-simple-endpoint.ytd-grid-video-renderer,
    ytd-rich-grid-media[mini-mode] #video-title.ytd-rich-grid-media,
    ytd-rich-grid-media #video-title:not(.ta-title-container),
    ytd-rich-grid-slim-media[mini-mode] #video-title.ytd-rich-grid-slim-media,
    ytd-video-renderer[is-backstage-video] #video-title.ytd-video-renderer,
    #video-title[class*="ytd"],
    yt-lockup-metadata-view-model .yt-lockup-metadata-view-model__title {
      -webkit-line-clamp: 20 !important;
      max-height: 44rem !important;
    }
  }

  if square-corners {
    * {
      border-radius: 0 !important;
    }
  }

  if hide-shorts {
    #dismissible.ytd-compact-video-renderer:has([href*="/shorts/"]),
    #items.ytd-grid-renderer > ytd-grid-video-renderer.ytd-grid-renderer:has([href*="/shorts/"]),
    #items.yt-horizontal-list-renderer > *.yt-horizontal-list-renderer:has([href*="/shorts/"]),
    #sections .ytd-guide-renderer:first-child ytd-guide-entry-renderer:nth-child(2),
    .style-scope .ytd-mini-guide-renderer:nth-child(2),
    a[title="Shorts"],
    grid-shelf-view-model,
    ytd-notification-renderer:has([href*="/shorts/"]),
    ytd-reel-shelf-renderer,
    ytd-reel-shelf-renderer:has([href*="/shorts/"]),
    ytd-video-renderer:has([href*="/shorts/"]),
    ytd-rich-item-renderer:has([href*="/shorts/"]):not([is-slim-media]),
    ytd-rich-section-renderer:has([is-shorts]),
    [page-subtype="subscriptions"] ytd-item-section-renderer:has([href*="/shorts/"]),
    [page-subtype="subscriptions"] ytd-rich-shelf-renderer[is-shorts],
    [page-subtype="channels"] .yt-tab-shape-wiz--host-clickable[tab-title="Shorts"],
    [page-subtype="hashtag-landing-page"] .yt-tab-shape-wiz--host-clickable[tab-title="Shorts"] {
      display: none !important;
    }
  }

  [is-search] ytd-shelf-renderer.ytd-item-section-renderer:not(ytd-channel-renderer + ytd-shelf-renderer),
  [is-search] ytd-horizontal-card-list-renderer.ytd-item-section-renderer:not(:first-child),
  [is-search] ytd-exploratory-results-renderer.ytd-item-section-renderer {
    display: none if filter-search-results;
  }

  if hide-promo-bar {
    #player-ads,
    #attached-survey,
    ytd-search-pyv-renderer,
    [page-subtype="home"] ytd-rich-section-renderer,
    ytd-rich-item-renderer:has(ytd-feed-nudge-renderer),
    [page-subtype="subscriptions"] ytd-rich-section-renderer,
    #masthead-ad:has(ytd-banner-promo-renderer),
    tp-yt-paper-dialog:has(yt-mealbar-promo-renderer),
    ytd-rich-item-renderer:has(ytd-ad-slot-renderer),
    ytd-rich-item-renderer:has(ytd-ad-slot-renderer),
    ytd-rich-item-renderer.ytd-rich-grid-row:has(ytd-ad-slot-renderer),
    ytd-rich-item-renderer.ytd-rich-grid-row:has(ytd-feed-nudge-renderer),
    ytd-rich-item-renderer:has(ytd-toggle-button-renderer button[aria-label="Notify me"]),
    ytd-ad-slot-renderer.ytd-item-section-renderer:has(ytd-promoted-sparkles-web-renderer),
    ytd-compact-video-renderer:has(ytd-badge-supported-renderer [aria-label="Members first"]),
    [page-subtype="home"] ytd-rich-item-renderer:has(.ytd-playlist-video-thumbnail-renderer),
    ytd-watch-next-secondary-results-renderer :is(ytd-ad-slot-renderer, ytd-compact-movie-renderer) {
      display: none !important;
    }
  }

  if compact-header {
    html {
      --ytd-toolbar-height: 36px;
    }

    ytd-feed-filter-chip-bar-renderer {
      --ytd-rich-grid-chips-bar-top: var(--ytd-toolbar-height);
    }

    ytd-app:not([scrolling]) {
      --ytd-masthead-height: var(--ytd-toolbar-height) !important;
    }

    .ytd-masthead:is(#container, #background),
    #header.ytd-app,
    ytd-masthead.shell {
      height: var(--ytd-toolbar-height);
    }

    #player.skeleton.theater {
      margin-top: var(--ytd-toolbar-height);
    }

    yt-searchbox,
    .ytd-searchbox:is(#search-form, #search-icon-legacy) {
      height: 30px !important;
    }

    yt-icon-button:is(.ytd-topbar-menu-button-renderer, .ytd-masthead, .ytd-notification-topbar-button-renderer),
    #masthead .yt-spec-button-shape-next--icon-only-default,
    #guide-button.ytd-app,
    .ytSearchboxComponentClearButton {
      width: 30px !important;
      height: 30px !important;
      padding: 3px;
    }

    .ytSearchboxComponentSuggestionsContainer {
      top: 30px;
    }

    yt-icon.ytd-logo {
      padding-top: 8px;
      padding-bottom: 8px;
    }

    #container.ytd-masthead,
    #header.ytd-app {
      padding: 0 21px;
    }
  }

  if smaller-search {
    ytd-two-column-search-results-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] #primary.ytd-two-column-search-results-renderer, ytd-search[has-search-header][has-bigger-thumbs] #header.ytd-search {
      max-width: 1096px !important;
    }

    ytd-channel-renderer[use-bigger-thumbs][bigger-thumb-style=BIG] #avatar-section.ytd-channel-renderer, ytd-channel-renderer[use-bigger-thumbs] #avatar-section.ytd-channel-renderer,
    ytd-video-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] ytd-thumbnail.ytd-video-renderer, ytd-video-renderer[use-search-ui] ytd-thumbnail.ytd-video-renderer,
    ytd-playlist-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] ytd-playlist-thumbnail.ytd-playlist-renderer, ytd-playlist-renderer[use-bigger-thumbs] ytd-playlist-thumbnail.ytd-playlist-renderer,
    ytd-radio-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] ytd-thumbnail.ytd-radio-renderer, ytd-radio-renderer[use-bigger-thumbs] ytd-thumbnail.ytd-radio-renderer,
    ytd-radio-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] ytd-thumbnail.ytd-radio-renderer, ytd-radio-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] ytd-playlist-thumbnail.ytd-radio-renderer,
    ytd-movie-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] .thumbnail-container.ytd-movie-renderer, ytd-movie-renderer[use-bigger-thumbs] .thumbnail-container.ytd-movie-renderer,
    ytd-promoted-video-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] ytd-thumbnail.ytd-promoted-video-renderer,
    ytd-promoted-sparkles-web-renderer[web-search-layout][use-bigger-thumbs][bigger-thumbs-style=BIG] #thumbnail-container.ytd-promoted-sparkles-web-renderer,
    ytd-text-image-no-button-layout-renderer[use-bigger-thumbs][bigger-thumbs-style=BIG] #text-image-container.ytd-text-image-no-button-layout-renderer,
    .yt-lockup-view-model-wiz--horizontal .yt-lockup-view-model-wiz__content-image,
    .yt-lockup-view-model--horizontal .yt-lockup-view-model__content-image {
      max-width: 360px !important;
    }
  }

  if hide-recommendations-bar {
    [page-subtype="home"] ytd-feed-filter-chip-bar-renderer,
    #home-chips,
    yt-related-chip-cloud-renderer {
      display: none;
    }

    #frosted-glass {
      height: var(--ytd-toolbar-height) !important;
    }
  }

  ytd-rich-section-renderer:has([is-post]) {
    display: none if hide-yt-posts;
  }
}

@-moz-document regexp("https?://www.youtube.com/watch.*"), regexp("https?://www.youtube.com/clip.*"), regexp("https?://www.youtube.com/embed.*"), regexp("https?://www.youtube.com/live.*") {
  if enable-theater-mode {
    ytd-watch-flexy[theater]:not([fullscreen]) #full-bleed-container.ytd-watch-flexy {
      height: 100vh;
      max-height: none;
      margin-top: calc(0px - var(--ytd-toolbar-height));
    }

    ytd-watch-flexy[fixed-panels] #chat.ytd-watch-flexy {
      top: 0;
    }

    #player.skeleton.theater {
      height: 100vh;
      margin-top: 0;
      max-height: none;
    }

    #masthead[is-watch-page][theater]:not([fullscreen]) {
      position: absolute;
      transform: translateY(calc(0px - var(--ytd-toolbar-height)));
      padding-bottom: 20px;
      transition: transform .3s ease, padding .3s ease;
    }

    #masthead[is-watch-page][theater]:not([fullscreen]):hover {
      transform: initial;
      padding-bottom: 0;
    }
  }

  if stretch-video {
    video {
      position: static !important;
      width: 100% !important;
      height: 100vh !important;
      transform: scaleX(1) !important;
      object-fit: fill !important;
    }
  }

  if hide-buttons {
    ytd-download-button-renderer {
      display: none !important;
    }

    #flexible-item-buttons [aria-label="Promote"],
    #flexible-item-buttons [aria-label="Clip"],
    #flexible-item-buttons [aria-label="Thanks"],
    #flexible-item-buttons [title="Show support with Super Thanks"] {
      display: none !important;
    }
  }

  if hide-suggestion-cards {
    .ytp-endscreen-content {
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.5s ease-out, transform 0.5s ease-out;
    }

    .ytp-endscreen-content:hover {
      opacity: 1;
      transform: scale(1);
    }

    div[class="ytp-videowall-still-image"]:not(.cb-visible) {
      visibility: visible !important;
    }
  }

  .ytp-ce-element-show {
    display: none if hide-end-cards;
  }

  if new-player-tweaks {
    #content .ytp-chrome-bottom {
      bottom: 0;
      height: 48px;
      width: 100%;
      z-index: 59;
      padding-top: 3px;
      text-align: left;
      direction: ltr;
    }

    #content .ytp-progress-bar-container {
      display: block;
      position: absolute;
      width: 100%;
      bottom: 47px;
      height: 5px;
    }

    #content .ytp-chrome-controls {
      height: inherit;
      font-size: 109%;
      text-align: left;
      direction: ltr;
    }

    #content .ytp-right-controls {
      height: inherit;
      margin: 0;
      padding: 0;
      border: 0;
      background: transparent;
      -webkit-backdrop-filter: blur(0px);
      backdrop-filter: blur(0px);
    }

    #content .ytp-right-controls-left {
      height: inherit;
    }

    #content .ytp-chrome-controls .ytp-play-button,
    #content .ytp-chrome-controls .ytp-prev-button,
    #content .ytp-chrome-controls .ytp-next-button {
      border-radius: 0;
      margin-top: 0;
      -webkit-backdrop-filter: blur(0px);
      backdrop-filter: blur(0px);
      background: transparent;
      text-shadow: 0 0 2px #000;
      padding: 0;
      text-align: center;
      height: 100%;
    }

    #content .ytp-chrome-controls .ytp-volume-area {
      border-radius: 0;
      margin-top: 0;
      -webkit-backdrop-filter: blur(0px);
      backdrop-filter: blur(0px);
      background: transparent;
      text-shadow: 0 0 2px #000;
      padding: 0;
      text-align: center;
      height: 100%;
      margin-left: 0;
    }


    #content .ytp-chrome-controls .ytp-play-button svg {
      padding: 0;
      width: 24px;
      height: 100%;
    }

    #content .ytp-time-display {
      padding: 0;
    }

    #content .ytp-time-wrapper,
    #content .ytp-chrome-controls .ytp-chapter-container .ytp-chapter-title,
    #content .ytp-chrome-controls .ytp-chapter-container .ytp-chapter-title:hover::after,
    #content .ytp-chrome-controls .ytp-prev-button:hover::after,
    #content .ytp-chrome-controls .ytp-next-button:hover::after {
      -webkit-backdrop-filter: blur(0px) !important;
      backdrop-filter: blur(0px) !important;
      background: transparent !important;
    }

    #content .ytp-chrome-controls .ytp-chapter-container {
      padding-top: 0;
    }

    #content .ytp-chrome-controls .ytp-right-controls .ytp-button:hover::before,
    #content .ytp-play-button:hover::after,
    #content .ytp-volume-area:hover::after,
    #content .ytp-time-wrapper:not(.ytp-miniplayer-ui *):hover::after {
      background-color: transparent;
    }

    #content .ytp-gradient-bottom {
      display: inherit;
    }
  }

  if enable-netflix-subtitles {
    @font-face {
      font-family: "Netflix Sans";
      font-weight: 100;
      src: url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Th.woff2") format("woff2"),
           url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Th.woff") format("woff");
    }

    @font-face {
      font-family: "Netflix Sans";
      font-weight: 300;
      src: url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Lt.woff2") format("woff2"),
           url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Lt.woff") format("woff");
    }

    @font-face {
      font-family: "Netflix Sans";
      font-weight: 400;
      src: url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Rg.woff2") format("woff2"),
           url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Rg.woff") format("woff");
    }

    @font-face {
      font-family: "Netflix Sans";
      font-weight: 700;
      src: url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Md.woff2") format("woff2"),
           url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Md.woff") format("woff");
    }

    @font-face {
      font-family: "Netflix Sans";
      font-weight: 800;
      src: url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Bd.woff2") format("woff2"),
           url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Bd.woff") format("woff");
    }

    @font-face {
      font-family: "Netflix Sans";
      font-weight: 900;
      src: url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Blk.woff2") format("woff2"),
           url("https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Blk.woff") format("woff");
    }

    .ytp-caption-segment {
      font-family: "Netflix Sans", sans-serif !important;
      font-weight: 700 !important;
      background: none !important;
      text-shadow: #000 0 0 0.2em !important;
    }
  }
}
